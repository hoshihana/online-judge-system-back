<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="pers.wjx.ojsb.repository.ProblemUserRepository">
    <insert id="increaseSubmit">
        insert into problem_user(user_id, problem_id, submit, accept)
        values (#{userId}, #{problemId}, 1, 0)
        on duplicate key update submit = submit + 1;
    </insert>
    <insert id="increaseAccept">
        insert into problem_user(user_id, problem_id, submit, accept)
        values (#{userId}, #{problemId}, 1, 1)
        on duplicate key update accept = accept + 1;
    </insert>
    <select id="getProblemUserRelation" resultType="pers.wjx.ojsb.pojo.ProblemUserRelation">
        select *
        from problem_user
        where user_id = #{userId} and problem_id = #{problemId}
    </select>
    <select id="countTriedUserByProblemId" resultType="java.lang.Integer">
        select count(*)
        from problem_user
        where problem_id = #{problemId} and submit > 0
    </select>
    <select id="countPassedUserByProblemId" resultType="java.lang.Integer">
        select count(*)
        from problem_user
        where problem_id = #{problemId} and accept > 0
    </select>
    <select id="countTriedProblemByUserId" resultType="java.lang.Integer">
        select count(*)
        from problem_user
        where user_id = #{userId} and submit > 0
    </select>
    <select id="countPassedProblemByUserId" resultType="java.lang.Integer">
        select count(*)
        from problem_user
        where user_id = #{userId} and accept > 0
    </select>
</mapper>